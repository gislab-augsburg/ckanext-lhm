<section class="additional-info module-content table1">
  <div class="collapsible-header">
    <h3 style="border-bottom: 0px solid;">{{_('Basic Information')}}</h3>
    <i class="plus-sign fa fa-minus"></i>
  </div>
  <div class="collapsible-content">
    <table class="table package-metadata" id="myTable">
      <tr>
        <td>
          <p class="heading">{{ _("Contact person") }}
          <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title="Angabe der Stelle, die fachliche und organisatorische Kenntnis zum Datensatz hat."></span></p>
            <p class="metadata">{{ pkg_dict.datenverantwortlicher }}</p>
        </td>
        <td>
            <p class="heading">{{ _("Contact person EMail") }}</p>
            {% if pkg_dict.datenverantwortlicher_email %}
              <p class="metadata">{{ h.mail_to(email_address=h.lhm_validate_email(pkg_dict.datenverantwortlicher_email), name=pkg_dict.datenverantwortlicher_email) }}</p>
            {% else %}
              <p class="metadata">{{ _("Not available") }}</p>
            {% endif %}
        </td>
        <td> 
          <p class="heading">{{ _("External Ownership") }}
          <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title="Um externe Datenurheber handelt es sich, wenn die Daten nicht von der Landeshautpststadt München stammen (z.B. LDBV, DWD, Here)"></span></p>
          {% if pkg_dict.ext_org%}     
            <p class="metadata">{{ pkg_dict.ext_org }}</p>
          {% else %}
            <p class="metadata">{{ _("No") }}</p>
          {% endif %}
        </td>
      </tr>
      <tr>
        <td>      
          <p class="heading">{{ _("Datenquelle") }}
          <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title="Die Datenquelle bezeichnet das System aus dem die Daten bezogen werden können, bspw. Geodatenpool"></span></p>
          {% if pkg_dict.type == "geodatenpool" %}
            <p class="metadata">{{ _("Geodatenpool") }}</p>
          {% elif  pkg_dict.type == "mobidam" %}
            <p class="metadata">{{ _("Mobidam") }}</p>
          {% else %}
            <p class="metadata">{{ _("Nicht verfügbar") }}</p>
          {% endif %}
        </td>
        <td>      
          <p class="heading">{{ _("Schema") }}
          <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title="Name des Datenbankschemas im Geodatenpool (z.B. BAUT, PLAN, RKU)"></span></p>
          {% if pkg_dict.schema %}
            <p class="metadata">{%- snippet 'package/snippets/label.html', item='schema', pkg_dict=pkg_dict, schema=schema -%}</p>
          {% else %}
            <p class="metadata">{{ _("Not available") }}</p>
          {% endif %}
        </td>
        <td>
          <p class="heading">{{ _("Timeliness") }}
            <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title="Der Update-Zyklus beschreibt, wann Daten aktualisiert werden. Dies kann monatlich oder auf Anforderung erfolgen. Zudem gibt es Daten, für die keine Aktualisierung vorgesehen ist."></span></p>
          {% if pkg_dict.update_zyklus %} 
            <p class="metadata">{%- snippet 'package/snippets/label.html',
              item='update_zyklus', pkg_dict=pkg_dict, schema=schema -%}</p>
          {% else %}
            <p class="metadata">{{ _("Not available") }}</p>
          {% endif %}
        </td>
      </tr>
      <tr>
        {% if pkg_dict.stadtarchiv %}
        <td colspan="3"><p class="heading">{{ _("City Archive")}}
          <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title="Archivwürdigkeit von historisch relevanten Daten. "></span></p>
          <p class="metadata">{%- snippet 'package/snippets/label.html',
            item='stadtarchiv', pkg_dict=pkg_dict, schema=schema -%}</p>
        </td>
        {% endif %}
      </tr>
      <tr>
        {% if pkg_dict.genauigkeit %}
        <td colspan="3"><p class="heading">{{ _("Accuracy")}}
          <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title="Die Genauigkeit der Daten hängt von der Art der Datenerhebung ab und gibt Auskunft darüber, für welche Anwendungsfälle die Daten geeignet sind. Ergänzend ist eine Information zu einem geeigneten Maßstab möglich."></span></p>
          <p class="metadata">{%- snippet 'package/snippets/label.html',
            item='genauigkeit', pkg_dict=pkg_dict, schema=schema -%}</p>
        </td>
        {% endif %}
      </tr>
      <tr>
        <td>
          <p class="heading">{{ _("Objekttyp") }}</p>
          {% if pkg_dict.geometrietyp %}  
            <p class="metadata">{%- snippet 'package/snippets/label.html',
              item='geometrietyp', pkg_dict=pkg_dict, schema=schema -%}</p>
          {% else %}
            <p class="metadata">{{ _("Not available") }}</p>
          {% endif %}
        </td>
      </tr>
    </table></div>
  </section>
  
  <section class="additional-info module-content table2">
    <div class="collapsible-header">
    <h3 style="border-bottom: 0px solid;">{{_('Usage Remarks')}}</h3>
    <i class="plus-sign fa fa-minus"></i>
  </div>
  <div class="collapsible-content">
    <table class="table package-metadata">
      <tr>
        <td style="padding-bottom: 0px;"><p class="heading">{{ _("LHM-intern")}}</p></td>
        {% if pkg_dict.lhm_intern %}
        <td style="padding-bottom: 0px;">
          <p class="heading">{{ _("Zugriff")}}
            <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title="Fachverfahren: Der Zugriff durch Fachverfahren meint den direkten (lesenden) Zugriff auf die Daten auf der Datenbank und/oder über Dienste. Standard ist der Zugriff für stadtweit alle Benutzer (d.h. Zugriffsuser inkl. GeoInfoWeb). Teilweise muss der Zugriff auf bestimmte Benutzergruppen (=Zugriffsuser) eingeschränkt werden oder die Daten dürfen nicht für Fachverfahren genutzt werden. 
GeoInfoWeb: Standard ist der Zugriff für stadtweit alle Benutzer (inkl. Stadtrat und Bezirksausschüsse). Der Zugriff über GeoInfoWeb kann auf bestimmte Gruppen begrenzt werden. Dann sind die Daten im GeoinfoWeb nur für diese Nutzer bzw. Gruppen sichtbar."></span>
          </p>
          <p class="metadata">{%- snippet 'package/snippets/label.html',
            item='lhm_intern', pkg_dict=pkg_dict, schema=schema -%}</p>
        </td>
        <td style="padding-bottom: 0px;"></td>
        {% endif %}     
      </tr>
      
      <tr>
        <td colspan="1" style="padding-bottom: 0px;"><p class="heading">{{ _("LHM-extern")}}</p></td>
        {% if pkg_dict.lhm_extern %}
        <td colspan="2" style="padding-bottom: 0px;">
          <p class="heading">{{ _("Zugriff")}}
            <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title='Information über die Zugriffsberechtigungen bzw. Bereitstellungsformen für Dritte, d.h. Personen und Organisationen außerhalb der LHM. "Backend-Daten und Präsentation" bezeichnet die Bereitstellung der Daten zur Nutzung in z.B. Online-Formularen und kartografischen Darstellungen. "Nur externe Auftragnehmer der LHM" bedeutet, dass die Daten an Dritte weitergegeben werden düren, sofern diese im Auftrag der Stadt tätig werden. "Nicht Auftragnehmer der LHM" gibt an, dass die Daten allgemein an Dritte weitergegeben werden dürfen. Es sind mögliche weitere Hinweise zur Nutzung zu beachten.'></span>
          </p>
          <p class="metadata">{%- snippet 'package/snippets/label.html',
            item='lhm_extern', pkg_dict=pkg_dict, schema=schema -%}</p>
        </td>
        {% endif %} 
      </tr>
      
      <tr>
        <td colspan="1" style="border-top: none;"><p class="heading">{{ _(" ")}}</p></td>
        <td colspan="2" style="border-top: none;">
          <p class="heading">{{ _("Open Data") }}
            <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title='Mit Open Data sind Daten gemeint, die frei verfügbar gemacht werden und frei genutzt werden können. Dies bedeutet jedoch nicht, dass es dabei keine Nutzungsbedingungen bzw. Lizenzbedingungen gibt. Ggf. inkludierte und exkludierte Attribute innerhalb des Datensatzes sind der Attributtabelle zu entnehmen. Weitere Hinweise zur Nutzung können unter "Hinweis" mit einem erläuternden Text beschrieben sein.--> Nutzungsrechte bei OpenData: https://opendata.muenchen.de/pages/nutzungsbedingungen'></span>
          </p>
          {% if pkg_dict.open_data %}  
            <p class="metadata">{%- snippet 'package/snippets/label.html',
              item='open_data', pkg_dict=pkg_dict, schema=schema -%}</p>
          {% else %}
            <p class="metadata">{{ _("Not available") }}</p>
          {% endif %}

          {% if pkg_dict.open_data != "nein" %}        
            <p class="metadata">{{ h.link_to('Nutzungsbedingungen Open Data', 'https://opendata.muenchen.de/pages/nutzungsbedingungen', target='_blank') }}</p>
          {% endif %}
        </td>
      </tr>
      
      <tr>
        <td style="border-top: none;"><p class="heading">{{ _(" ")}}</p></td>
        <td style="border-top: none;">
          <p class="heading">{{ _("High Value Datasets (HVD)") }}
            <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title='High Value Datasets sind Daten, die in unter die HVD Durchführungsverordnung (DVO-HVD) fallen.'></span>
          </p>
            <p class="metadata">{%- snippet 'package/snippets/label.html',
              item='hvd', pkg_dict=pkg_dict, schema=schema -%}</p>
            {% if pkg_dict.hvd != "nein"%}  
            <p class="metadata">{{ h.link_to('Durchführungsverordnung HVD', 'https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://eur-lex.europa.eu/legal-content/DE/TXT/PDF/%3Furi%3DCELEX:32023R0138%26from%3DDE&ved=2ahUKEwidrpDW3YmMAxUYRfEDHbxQEckQFnoECAkQAQ&usg=AOvVaw3WDQRF0xfddSJsN4ZaSxFO', target='_blank') }}</p>
            <p class="metadata">{{ h.link_to('FAQs zur DVO-HVD', 'https://www.govdata.de/informationen/hochwertige-datensaetze', target='_blank') }}</p>
            {% endif %}
        </td>
        <td style="border-top: none;">
          <p class="heading">{{ _("HVD-Kategorie") }}
            <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title='HVD-Kategorie gemäß DVO-HVD'></span>
          </p>
          {% if pkg_dict.hvd_kategorie %}  
            <p class="metadata">{%- snippet 'package/snippets/label.html',
              item='hvd_kategorie', pkg_dict=pkg_dict, schema=schema -%}</p>
          {% else %}
            <p class="metadata">{{ _("Not available") }}</p>
          {% endif %}
        </td>
      </tr>
      
      {% if pkg_dict.open_data_attribute %} 
      <tr>
        <td colspan="1" style="border-top: none;"><p class="heading">{{ _(" ")}}</p></td>
        <td colspan="2" style="border-top: none;">
          <p class="heading">{{ _("Open Data / HVD bestimmte Attribute") }}
            <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title='Nur folgende Attribute sind Open Data oder High Value Data'></span>
          </p> 
            <p class="metadata">{{ pkg_dict.open_data_attribute }}</p>
        </td>
      </tr>
      {% endif %}
    </table></div>
  </section>
  
  
  <section class="additional-info module-content table3">
    <div class="collapsible-header">
      <h3 style="border-bottom: 0px solid;">{{ _("Weitere Hinweise zur Nutzung")}}</h3>
      <i class="plus-sign fa fa-minus"></i>
    </div>
    <div class="collapsible-content">
      <table class="table package-metadata">
        {% if pkg_dict.nutzungshinweise %}
        <tr>
          <td colspan="4">
            <p class="metadata">{%- snippet 'package/snippets/label.html',
              item='nutzungshinweise', pkg_dict=pkg_dict, schema=schema -%}</p>
          </td>
        </tr>
        {% endif %}
        {% if pkg_dict.eignung_geschaeftsprozesse_it %}
        <tr>
          <td colspan="4">
            <p class="heading">{{ _("Eignung für Geschäftprozesse und IT-Systeme") }}
            <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title="Gewährleistung der dauerhaften Zurverfügungstellung des Datensatzes."></span></p>
              <p class="metadata">{%- snippet 'package/snippets/label.html',
                item='eignung_geschaeftsprozesse_it', pkg_dict=pkg_dict, schema=schema -%}</p>
          </td>
        </tr>
        {% endif %}
      </table></div>
    </section>
  
  
  <!--
  {% set chg_his = pkg_dict.change_history %}
  {% if chg_his %}
    <section class="additional-info module-content table4">
      <table class="table package-metadata">
        <tr>
          <td colspan="3"><p class="heading">{{ _("Change History")}}</p>
            <p class="metadata">{%- snippet 'package/snippets/label.html',
              item='change_history', pkg_dict=pkg_dict, schema=schema -%}</p>
          </td>
        </tr>
      </table>
    </section>
  {% endif %}-->
  {% set res = pkg_dict.resources[0] %} 
  {% if res and res.datastore_active %}
  {% block resource_data_dictionary %}
    <section class="module-content table4">
      <div class="collapsible-header">
      <h3 style="border-bottom: 0px solid;">{{ _('Data Dictionary') }}</h3>
      <i class="plus-sign fa fa-minus"></i>
    </div>
    <div class="collapsible-content">
      <hr style="margin-top: 0; border-block-color: #dbdcdc;">
      <table class="table table-striped table-bordered table-condensed" data-module="table-toggle-more">
        {% block resouce_data_dictionary_headers %}
        <tr>
          <th scope="col">{{ _('Attribute') }}</th>
          <th scope="col">{{ _('Data Type') }}</th>
          <th scope="col">{{ _('Conditions') }}</th>
          <th scope="col">{{ _('Description') }}
            <span class="fa fa-info-circle" style="font-size: 11pt;" data-toggle="tooltip" title="Auch: Fachliche Bezeichnung"></span>
          </th>
          <th scope="col">{{ _('Remarks') }}</th>
          <th scope="col">{{ _('Open Data') }}</th>
        </tr>
        {% endblock %}
      
        {% block resource_data_dictionary_data %}
          {% set dict=h.datastore_dictionary(res.id) %}
          {% for field in dict %}
            {% snippet "package/snippets/dictionary_view.html", field=field %}
          {% endfor %}
        {% endblock %}
      </table></div>
    </section>
  {% endblock %}
  {% endif %}


  <script>
        document.addEventListener("DOMContentLoaded", function() {
            const collapsibleHeaders = document.querySelectorAll(".collapsible-header");
            
            collapsibleHeaders.forEach(header => {
                const collapsibleContent = header.nextElementSibling;
                const icon = header.querySelector(".plus-sign");

                header.addEventListener("click", function() {
                    collapsibleContent.classList.toggle("hide");
                    icon.classList.toggle("fa-minus");
                    icon.classList.toggle("fa-plus");
                });
            });
        });
</script>